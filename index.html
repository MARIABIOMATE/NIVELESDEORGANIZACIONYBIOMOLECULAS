<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioExplorer - Organizaci√≥n del Cuerpo Humano</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 30px;
            animation: slideDown 0.5s ease;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .menu-screen, .theory-screen, .quiz-screen, .final-screen {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .level-cards {
            display: grid;
            gap: 20px;
            margin-top: 30px;
        }

        .level-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .level-card:hover:not(.locked) {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .level-card.locked {
            background: linear-gradient(135deg, #718096, #4a5568);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .level-card.completed {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .level-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-card p {
            opacity: 0.95;
            line-height: 1.6;
        }

        .theory-content {
            max-height: 70vh;
            overflow-y: auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            color: #333;
        }

        .theory-content h2 {
            color: #667eea;
            margin: 25px 0 15px 0;
            font-size: 1.4em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .theory-content ul {
            margin-left: 20px;
            line-height: 1.8;
        }

        .theory-content li {
            margin: 10px 0;
            list-style: none;
            position: relative;
            padding-left: 25px;
        }

        .theory-content li::before {
            content: "üî¨";
            position: absolute;
            left: 0;
        }

        .button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            display: inline-block;
            text-align: center;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .quiz-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            color: #333;
        }

        .question {
            font-size: 1.3em;
            margin-bottom: 25px;
            color: #2d3748;
            font-weight: 500;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .option:hover {
            background: #edf2f7;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .option.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #48bb78;
            color: white;
            border-color: #48bb78;
            animation: pulse 0.5s ease;
        }

        .option.incorrect {
            background: #f56565;
            color: white;
            border-color: #f56565;
            animation: shake 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            animation: slideUp 0.3s ease;
        }

        .feedback.correct {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #48bb78;
        }

        .feedback.incorrect {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #f56565;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .stats {
            display: flex;
            justify-content: space-between;
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .floating-theory {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .theory-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .theory-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            background: white;
            border-radius: 20px;
            padding: 30px;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2em;
            cursor: pointer;
            color: #718096;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #2d3748;
        }

        .code-display {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.5em;
            font-weight: bold;
            letter-spacing: 2px;
            box-shadow: 0 5px 20px rgba(72, 187, 120, 0.3);
        }

        .progress-bar {
            background: #e2e8f0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .container {
                padding: 10px;
            }
            
            .floating-theory {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî¨ BioExplorer üß¨</h1>
            <p>Organizaci√≥n del Cuerpo Humano - 3¬∫ ESO</p>
        </div>

        <!-- Pantalla de Men√∫ -->
        <div id="menuScreen" class="menu-screen">
            <h2 style="color: #667eea; text-align: center; margin-bottom: 20px;">
                Selecciona un Nivel üöÄ
            </h2>
            <div class="level-cards">
                <div class="level-card" onclick="startLevel(1)" id="level1Card">
                    <h3>‚öõÔ∏è Nivel 1: Niveles de Organizaci√≥n</h3>
                    <p>Descubre c√≥mo se organiza la materia desde los √°tomos hasta la biosfera.</p>
                </div>
                <div class="level-card locked" id="level2Card">
                    <h3>üß¨ Nivel 2: Biomol√©culas B√°sicas</h3>
                    <p>Explora los compuestos qu√≠micos esenciales para la vida.</p>
                </div>
                <div class="level-card locked" id="level3Card">
                    <h3>üí™ Nivel 3: Prote√≠nas</h3>
                    <p>Conoce las biomol√©culas m√°s vers√°tiles y sus funciones.</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <p style="color: #718096;">Puntuaci√≥n Total: <span id="totalScoreMenu" style="color: #667eea; font-weight: bold;">0</span></p>
            </div>
        </div>

        <!-- Pantalla de Teor√≠a -->
        <div id="theoryScreen" class="theory-screen" style="display: none;">
            <h2 style="color: #667eea; text-align: center; margin-bottom: 20px;">
                üìö Estudia la Teor√≠a
            </h2>
            <div class="theory-content" id="theoryContent"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="button" onclick="startQuiz()">
                    Comenzar Preguntas üéØ
                </button>
            </div>
        </div>

        <!-- Pantalla de Quiz -->
        <div id="quizScreen" class="quiz-screen" style="display: none;">
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="questionNumber">1</div>
                    <div class="stat-label">Pregunta</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="score">0</div>
                    <div class="stat-label">Puntos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">Aciertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="incorrectAnswers">0</div>
                    <div class="stat-label">Errores</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="quiz-container">
                <div class="question" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
                <div id="feedbackContainer"></div>
            </div>
        </div>

        <!-- Pantalla Final -->
        <div id="finalScreen" class="final-screen" style="display: none;">
            <div style="text-align: center;">
                <h2 style="color: #667eea; font-size: 2.5em; margin-bottom: 20px;">
                    üéâ ¬°Enhorabuena! üéâ
                </h2>
                <p style="font-size: 1.3em; color: #4a5568; margin-bottom: 30px;">
                    Has completado todos los niveles
                </p>
                <div style="background: #f7fafc; padding: 30px; border-radius: 15px; margin: 20px 0;">
                    <h3 style="color: #2d3748; margin-bottom: 20px;">Tus Resultados</h3>
                    <div style="font-size: 3em; color: #667eea; font-weight: bold;">
                        <span id="finalScore">0</span> puntos
                    </div>
                    <p style="color: #718096; margin-top: 10px;">Puntuaci√≥n Total</p>
                </div>
                <div style="background: #fef5e7; padding: 20px; border-radius: 15px; margin: 20px 0; border: 2px solid #f39c12;">
                    <h3 style="color: #e67e22; margin-bottom: 15px;">üìù C√≥digos para el Profesor</h3>
                    <p style="color: #8b6914; margin-bottom: 15px;">Muestra estos c√≥digos a tu profesor:</p>
                    <div id="codesContainer"></div>
                </div>
                <button class="button" onclick="resetGame()">
                    Volver a Empezar üîÑ
                </button>
            </div>
        </div>

        <!-- Bot√≥n flotante de teor√≠a -->
        <div class="floating-theory" id="floatingTheory" style="display: none;">
            <button class="button" onclick="showTheoryModal()">
                üìñ Ver Teor√≠a
            </button>
        </div>

        <!-- Modal de teor√≠a -->
        <div id="theoryModal" class="theory-modal">
            <div class="theory-modal-content">
                <span class="close-modal" onclick="closeTheoryModal()">&times;</span>
                <h2 style="color: #667eea; margin-bottom: 20px;">üìö Teor√≠a del Nivel</h2>
                <div id="modalTheoryContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Datos del juego
        const gameData = {
            currentLevel: 0,
            currentQuestion: 0,
            score: 0,
            totalScore: 0,
            correctAnswers: 0,
            incorrectAnswers: 0,
            levelScores: [0, 0, 0],
            completedLevels: [],
            codes: [],
            attemptedCurrent: false
        };

        // Teor√≠a de cada nivel
        const theories = {
            1: `
                <h2>‚öõÔ∏è Niveles de Organizaci√≥n</h2>
                <ul>
                    <li><strong>√Åtomos:</strong> Part√≠culas fundamentales que forman toda la materia del universo</li>
                    <li><strong>Mol√©culas:</strong> Uni√≥n qu√≠mica de dos o m√°s √°tomos que forman compuestos</li>
                    <li><strong>C√©lula:</strong> Unidad estructural y funcional de la vida, formada por la uni√≥n de mol√©culas organizadas</li>
                    <li><strong>Tejidos:</strong> Agrupaci√≥n de c√©lulas semejantes que realizan una funci√≥n determinada en el organismo</li>
                    <li><strong>√ìrganos:</strong> Conjunto de diferentes tejidos que trabajan coordinadamente para realizar una funci√≥n espec√≠fica</li>
                    <li><strong>Sistemas:</strong> Conjunto de √≥rganos que act√∫an de forma coordinada para realizar funciones vitales complejas</li>
                    <li><strong>Organismo:</strong> Ser vivo individual pluricelular formado por sistemas que funcionan como una unidad</li>
                    <li><strong>Especie:</strong> Conjunto de organismos con capacidad de reproducirse entre s√≠ y tener descendencia f√©rtil</li>
                    <li><strong>Poblaci√≥n:</strong> Individuos de la misma especie que viven en un mismo lugar y tiempo compartiendo recursos</li>
                    <li><strong>Comunidad:</strong> Conjunto de poblaciones de diferentes especies que viven e interact√∫an en un mismo lugar</li>
                    <li><strong>Ecosistema:</strong> Sistema formado por la comunidad de seres vivos m√°s el medio f√≠sico donde habitan</li>
                    <li><strong>Biosfera:</strong> Conjunto de todos los ecosistemas del planeta Tierra donde existe vida</li>
                </ul>
            `,
            2: `
                <h2>üß¨ Bioelementos</h2>
                <ul>
                    <li><strong>Macroelementos (C, H, O, N, P, S):</strong> Son los elementos m√°s abundantes en los seres vivos, forman la estructura b√°sica de todas las biomol√©culas</li>
                    <li><strong>Microelementos (Na, K, Cl, Mg, Ca, Si):</strong> Presentes en menor cantidad pero imprescindibles para funciones vitales como la transmisi√≥n nerviosa</li>
                    <li><strong>Oligoelementos (Cr, Co, Fe, Zn):</strong> Se encuentran en cantidades muy peque√±as pero son esenciales para el metabolismo</li>
                </ul>
                
                <h2>üíß Biomol√©culas Inorg√°nicas</h2>
                <ul>
                    <li><strong>Agua (H‚ÇÇO):</strong> Constituye el 70% del organismo, es el disolvente universal e imprescindible en todos los procesos biol√≥gicos</li>
                    <li><strong>Sales minerales:</strong> Combinaci√≥n de cationes y aniones que forman estructuras s√≥lidas como el carbonato c√°lcico en los huesos</li>
                </ul>
                
                <h2>üçØ Gl√∫cidos o Hidratos de Carbono</h2>
                <ul>
                    <li><strong>Composici√≥n:</strong> Biomol√©culas org√°nicas formadas por carbono (C), hidr√≥geno (H) y ox√≠geno (O)</li>
                    <li><strong>Monosac√°ridos y disac√°ridos:</strong> Son az√∫cares simples de sabor dulce, solubles en agua y con funci√≥n principalmente energ√©tica</li>
                    <li><strong>Polisac√°ridos:</strong> Son az√∫cares complejos sin sabor dulce, insolubles en agua, que sirven como reserva energ√©tica o funci√≥n estructural</li>
                </ul>
                
                <h2>ü•ë L√≠pidos o Grasas</h2>
                <ul>
                    <li><strong>Composici√≥n:</strong> Biomol√©culas formadas por C, H y O en menor cantidad que los gl√∫cidos</li>
                    <li><strong>Caracter√≠stica principal:</strong> Todos los l√≠pidos son insolubles en agua (hidrof√≥bicos)</li>
                    <li><strong>Funciones:</strong> Energ√©tica, estructural (membranas celulares) y reguladora (hormonas)</li>
                    <li><strong>√Åcidos grasos saturados:</strong> Enlaces simples C-C, s√≥lidos a temperatura ambiente, m√°s perjudiciales</li>
                    <li><strong>√Åcidos grasos insaturados:</strong> Dobles enlaces C=C, l√≠quidos a temperatura ambiente, beneficiosos para la salud</li>
                </ul>
            `,
            3: `
                <h2>üí™ Estructura de las Prote√≠nas</h2>
                <ul>
                    <li><strong>Composici√≥n qu√≠mica:</strong> Biomol√©culas org√°nicas compuestas principalmente por C, H, O y N, y ocasionalmente P y S</li>
                    <li><strong>Unidades b√°sicas:</strong> Formadas por cadenas de amino√°cidos, existiendo 20 amino√°cidos diferentes</li>
                    <li><strong>Importancia:</strong> Son las biomol√©culas m√°s vers√°tiles y esenciales para la vida</li>
                </ul>
                
                <h2>üõ°Ô∏è Funci√≥n de Defensa</h2>
                <ul>
                    <li><strong>Anticuerpos o inmunoglobulinas:</strong> Prote√≠nas que protegen al organismo identificando y neutralizando pat√≥genos</li>
                    <li><strong>Mecanismo:</strong> Se adhieren al pat√≥geno y lo neutralizan o alertan al sistema inmune</li>
                </ul>
                
                <h2>ü¶µ Funci√≥n Contr√°ctil</h2>
                <ul>
                    <li><strong>Actina y miosina:</strong> Prote√≠nas musculares que permiten la contracci√≥n y relajaci√≥n de los m√∫sculos</li>
                </ul>
                
                <h2>ü¶¥ Funci√≥n Estructural</h2>
                <ul>
                    <li><strong>Glucoprote√≠nas:</strong> Forman parte de la membrana celular dando estructura</li>
                    <li><strong>Col√°geno:</strong> Prote√≠na abundante en tendones, piel y huesos que proporciona flexibilidad</li>
                    <li><strong>Queratina:</strong> Prote√≠na que forma el pelo, u√±as y capa externa de la piel</li>
                </ul>
                
                <h2>ü´Å Funci√≥n de Transporte</h2>
                <ul>
                    <li><strong>Hemoglobina:</strong> Prote√≠na de los gl√≥bulos rojos que transporta ox√≠geno</li>
                    <li><strong>Lipoprote√≠nas:</strong> Transportan l√≠pidos (grasas) por la sangre</li>
                </ul>
                
                <h2>‚ö° Funci√≥n Enzim√°tica</h2>
                <ul>
                    <li><strong>Enzimas:</strong> Prote√≠nas que aceleran (catalizan) las reacciones qu√≠micas del metabolismo</li>
                    <li><strong>Ejemplos:</strong> Amilasa (digiere almid√≥n), pepsina (digiere prote√≠nas), lipasa (digiere grasas)</li>
                </ul>
                
                <h2>ü´Ä Funci√≥n Hormonal</h2>
                <ul>
                    <li><strong>Hormonas proteicas:</strong> Regulan m√∫ltiples procesos fisiol√≥gicos como mensajeros qu√≠micos</li>
                    <li><strong>Insulina:</strong> Hormona que regula el metabolismo de la glucosa</li>
                </ul>
            `
        };

        // Preguntas de cada nivel
        const questions = {
            1: [
                {
                    question: "¬øCu√°l es la unidad estructural y funcional de vida?",
                    options: ["√Åtomo", "C√©lula", "Tejido", "Mol√©cula"],
                    correct: 1,
                    explanation: "La c√©lula es la unidad estructural y funcional de vida, formada por mol√©culas organizadas."
                },
                {
                    question: "¬øQu√© nivel viene despu√©s de los tejidos?",
                    options: ["Sistema", "√ìrganos", "Poblaci√≥n", "C√©lula"],
                    correct: 1,
                    explanation: "Los √≥rganos son el conjunto de diferentes tejidos que trabajan coordinadamente."
                },
                {
                    question: "¬øQu√© es una poblaci√≥n?",
                    options: ["Individuos de especies diferentes", "Individuos de la misma especie en un lugar", "Conjunto de tejidos", "Un ecosistema"],
                    correct: 1,
                    explanation: "Poblaci√≥n: individuos de la misma especie que viven en un mismo lugar y tiempo."
                },
                {
                    question: "¬øQu√© es un ecosistema?",
                    options: ["Solo organismos", "Comunidad + medio f√≠sico", "Grupo de c√©lulas", "Solo el ambiente"],
                    correct: 1,
                    explanation: "Ecosistema = comunidad de seres vivos + medio f√≠sico donde habitan."
                }
            ],
            2: [
                {
                    question: "¬øCu√°les son los macroelementos principales?",
                    options: ["Na, K, Cl", "C, H, O, N, P, S", "Cr, Co", "Fe, Zn"],
                    correct: 1,
                    explanation: "Macroelementos: C, H, O, N, P, S son los m√°s abundantes en los seres vivos."
                },
                {
                    question: "¬øQu√© porcentaje del organismo es agua?",
                    options: ["50%", "60%", "70%", "80%"],
                    correct: 2,
                    explanation: "El agua constituye el 70% del organismo, siendo el disolvente universal."
                },
                {
                    question: "¬øQu√© sales forman parte de los huesos?",
                    options: ["Cloruro s√≥dico", "Carbonato c√°lcico", "Sulfato de magnesio", "Fosfato de potasio"],
                    correct: 1,
                    explanation: "El carbonato c√°lcico forma parte de huesos, conchas y caparazones."
                },
                {
                    question: "Funci√≥n de monosac√°ridos y disac√°ridos:",
                    options: ["Estructural", "Energ√©tica", "Transporte", "Defensa"],
                    correct: 1,
                    explanation: "Monosac√°ridos y disac√°ridos tienen funci√≥n energ√©tica, son dulces y solubles."
                },
                {
                    question: "Caracter√≠stica de todos los l√≠pidos:",
                    options: ["Son dulces", "Insolubles en agua", "Tienen nitr√≥geno", "Son prote√≠nas"],
                    correct: 1,
                    explanation: "Todos los l√≠pidos son insolubles en agua (hidrof√≥bicos)."
                },
                {
                    question: "¬øQu√© √°cidos grasos son m√°s saludables?",
                    options: ["Saturados", "Insaturados", "Ambos igual", "Ninguno"],
                    correct: 1,
                    explanation: "Insaturados: reducen colesterol malo LDL y aumentan el bueno HDL."
                }
            ],
            3: [
                {
                    question: "¬øCu√°ntos amino√°cidos forman las prote√≠nas?",
                    options: ["10", "15", "20", "25"],
                    correct: 2,
                    explanation: "Las prote√≠nas est√°n formadas por 20 amino√°cidos diferentes."
                },
                {
                    question: "¬øQu√© prote√≠nas defienden de pat√≥genos?",
                    options: ["Actina", "Anticuerpos", "Col√°geno", "Hemoglobina"],
                    correct: 1,
                    explanation: "Anticuerpos o inmunoglobulinas defienden contra virus, bacterias y hongos."
                },
                {
                    question: "Prote√≠nas de la contracci√≥n muscular:",
                    options: ["Insulina y glucag√≥n", "Actina y miosina", "Col√°geno y queratina", "Hemoglobina"],
                    correct: 1,
                    explanation: "Actina y miosina permiten la contracci√≥n muscular y el movimiento."
                },
                {
                    question: "Prote√≠na que da flexibilidad a tendones:",
                    options: ["Queratina", "Col√°geno", "Insulina", "Hemoglobina"],
                    correct: 1,
                    explanation: "Col√°geno: proporciona flexibilidad y resistencia a tendones y piel."
                },
                {
                    question: "¬øQu√© transporta la hemoglobina?",
                    options: ["Glucosa", "Ox√≠geno", "L√≠pidos", "Prote√≠nas"],
                    correct: 1,
                    explanation: "Hemoglobina transporta ox√≠geno desde los pulmones a las c√©lulas."
                },
                {
                    question: "Funci√≥n de las enzimas:",
                    options: ["Defender", "Acelerar reacciones", "Transportar", "Formar estructuras"],
                    correct: 1,
                    explanation: "Enzimas aceleran (catalizan) las reacciones qu√≠micas del metabolismo."
                }
            ]
        };

        // Palabras para c√≥digos aleatorios
        const codeWords = ["CELULA", "PROTEINA", "LIPIDO", "GLUCIDO", "TEJIDO", "ORGANO", 
                          "ATOMO", "MOLECULA", "ENZIMA", "INSULINA", "COLAGENO", 
                          "ECOSISTEMA", "POBLACION", "BIOSFERA", "COMUNIDAD", "ESPECIE"];

        // Funciones del juego
        function startLevel(level) {
            if (level === 1 || gameData.completedLevels.includes(level - 1)) {
                gameData.currentLevel = level;
                gameData.currentQuestion = 0;
                gameData.score = 0;
                gameData.correctAnswers = 0;
                gameData.incorrectAnswers = 0;
                showTheory();
            }
        }

        function showTheory() {
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('theoryScreen').style.display = 'block';
            document.getElementById('theoryContent').innerHTML = theories[gameData.currentLevel];
            document.getElementById('modalTheoryContent').innerHTML = theories[gameData.currentLevel];
        }

        function startQuiz() {
            document.getElementById('theoryScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            document.getElementById('floatingTheory').style.display = 'block';
            gameData.attemptedCurrent = false;
            showQuestion();
        }

        function showQuestion() {
            const levelQuestions = questions[gameData.currentLevel];
            const currentQ = levelQuestions[gameData.currentQuestion];
            
            document.getElementById('questionNumber').textContent = gameData.currentQuestion + 1;
            document.getElementById('score').textContent = gameData.score;
            document.getElementById('correctAnswers').textContent = gameData.correctAnswers;
            document.getElementById('incorrectAnswers').textContent = gameData.incorrectAnswers;
            
            // Actualizar barra de progreso
            const progress = ((gameData.currentQuestion) / levelQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('questionText').textContent = currentQ.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            currentQ.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('feedbackContainer').innerHTML = '';
            gameData.attemptedCurrent = false;
        }

        function selectOption(index) {
            if (gameData.attemptedCurrent && questions[gameData.currentLevel][gameData.currentQuestion].correct === index) {
                return;
            }
            
            const options = document.querySelectorAll('.option');
            const currentQ = questions[gameData.currentLevel][gameData.currentQuestion];
            const feedbackContainer = document.getElementById('feedbackContainer');
            
            options.forEach((opt, i) => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.onclick = null;
            });
            
            if (index === currentQ.correct) {
                // Respuesta correcta
                options[index].classList.add('correct');
                
                if (!gameData.attemptedCurrent) {
                    gameData.score += 10;
                    gameData.correctAnswers++;
                } else {
                    gameData.score += 5;
                }
                
                feedbackContainer.innerHTML = `
                    <div class="feedback correct">
                        ‚úÖ ¬°Correcto! ${currentQ.explanation}
                    </div>
                `;
                
                document.getElementById('score').textContent = gameData.score;
                document.getElementById('correctAnswers').textContent = gameData.correctAnswers;
                
                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            } else {
                // Respuesta incorrecta
                options[index].classList.add('incorrect');
                
                if (!gameData.attemptedCurrent) {
                    gameData.incorrectAnswers++;
                    gameData.attemptedCurrent = true;
                }
                
                feedbackContainer.innerHTML = `
                    <div class="feedback incorrect">
                        ‚ùå Incorrecto. ${currentQ.explanation}
                        <button class="button" style="margin-top: 10px;" onclick="retryQuestion()">
                            Intentar de nuevo (-5 puntos)
                        </button>
                    </div>
                `;
                
                document.getElementById('incorrectAnswers').textContent = gameData.incorrectAnswers;
            }
        }

        function retryQuestion() {
            showQuestion();
        }

        function nextQuestion() {
            gameData.currentQuestion++;
            const levelQuestions = questions[gameData.currentLevel];
            
            if (gameData.currentQuestion < levelQuestions.length) {
                showQuestion();
            } else {
                completeLevel();
            }
        }

        function completeLevel() {
            // Generar c√≥digo aleatorio
            const randomCode = codeWords[Math.floor(Math.random() * codeWords.length)];
            gameData.codes.push(`Nivel ${gameData.currentLevel}: ${randomCode}`);
            
            // Guardar puntuaci√≥n del nivel
            gameData.levelScores[gameData.currentLevel - 1] = gameData.score;
            gameData.totalScore += gameData.score;
            
            // Marcar nivel como completado
            if (!gameData.completedLevels.includes(gameData.currentLevel)) {
                gameData.completedLevels.push(gameData.currentLevel);
            }
            
            // Mostrar c√≥digo y continuar
            alert(`¬°Nivel ${gameData.currentLevel} completado!\n\nPuntos: ${gameData.score}\nC√≥digo: ${randomCode}\n\n¬°Recuerda este c√≥digo para tu profesor!`);
            
            document.getElementById('floatingTheory').style.display = 'none';
            
            if (gameData.completedLevels.length === 3) {
                showFinalScreen();
            } else {
                returnToMenu();
            }
        }

        function returnToMenu() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'block';
            document.getElementById('totalScoreMenu').textContent = gameData.totalScore;
            
            // Actualizar estado de las tarjetas
            gameData.completedLevels.forEach(level => {
                document.getElementById(`level${level}Card`).classList.add('completed');
            });
            
            // Desbloquear siguiente nivel
            if (gameData.completedLevels.includes(1)) {
                document.getElementById('level2Card').classList.remove('locked');
                document.getElementById('level2Card').onclick = () => startLevel(2);
            }
            if (gameData.completedLevels.includes(2)) {
                document.getElementById('level3Card').classList.remove('locked');
                document.getElementById('level3Card').onclick = () => startLevel(3);
            }
        }

        function showFinalScreen() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('finalScreen').style.display = 'block';
            document.getElementById('finalScore').textContent = gameData.totalScore;
            
            // Mostrar todos los c√≥digos
            const codesContainer = document.getElementById('codesContainer');
            codesContainer.innerHTML = '';
            gameData.codes.forEach(code => {
                const codeDiv = document.createElement('div');
                codeDiv.className = 'code-display';
                codeDiv.textContent = code;
                codesContainer.appendChild(codeDiv);
            });
        }

        function resetGame() {
            // Reiniciar todos los datos del juego
            gameData.currentLevel = 0;
            gameData.currentQuestion = 0;
            gameData.score = 0;
            gameData.totalScore = 0;
            gameData.correctAnswers = 0;
            gameData.incorrectAnswers = 0;
            gameData.levelScores = [0, 0, 0];
            gameData.completedLevels = [];
            gameData.codes = [];
            gameData.attemptedCurrent = false;
            
            // Reiniciar interfaz
            document.getElementById('finalScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'block';
            document.getElementById('totalScoreMenu').textContent = '0';
            
            // Resetear tarjetas de nivel
            document.getElementById('level1Card').classList.remove('completed');
            document.getElementById('level2Card').classList.remove('completed');
            document.getElementById('level2Card').classList.add('locked');
            document.getElementById('level2Card').onclick = null;
            document.getElementById('level3Card').classList.remove('completed');
            document.getElementById('level3Card').classList.add('locked');
            document.getElementById('level3Card').onclick = null;
        }

        function showTheoryModal() {
            document.getElementById('theoryModal').style.display = 'block';
        }

        function closeTheoryModal() {
            document.getElementById('theoryModal').style.display = 'none';
        }

        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const modal = document.getElementById('theoryModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>