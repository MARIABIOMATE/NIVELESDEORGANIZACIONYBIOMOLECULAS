<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BioExplorer - Organizaci√≥n del Cuerpo Humano</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            text-align: center;
            padding: 30px 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            margin-bottom: 30px;
            animation: slideDown 0.5s ease;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .menu-screen, .theory-screen, .quiz-screen, .final-screen {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .level-cards {
            display: grid;
            gap: 20px;
            margin-top: 30px;
        }

        .level-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .level-card:hover:not(.locked) {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .level-card.locked {
            background: linear-gradient(135deg, #718096, #4a5568);
            cursor: not-allowed;
            opacity: 0.7;
        }

        .level-card.completed {
            background: linear-gradient(135deg, #48bb78, #38a169);
        }

        .level-card h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .level-card p {
            opacity: 0.95;
            line-height: 1.6;
        }

        /* TEOR√çA MEJORADA */
        .theory-content {
            max-height: 70vh;
            overflow-y: auto;
            padding: 20px;
            background: linear-gradient(to bottom, #f0f9ff, #e0f2fe);
            border-radius: 15px;
            color: #1e293b;
        }

        .theory-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
            transition: transform 0.3s ease;
        }

        .theory-section:hover {
            transform: translateX(5px);
        }

        .theory-title {
            color: #667eea;
            font-size: 1.8em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .theory-subtitle {
            color: #764ba2;
            font-size: 1.3em;
            margin: 20px 0 10px 0;
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 5px;
        }

        .concept-card {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #fbbf24;
            transition: all 0.3s ease;
        }

        .concept-card:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 15px rgba(251, 191, 36, 0.3);
        }

        .concept-title {
            color: #92400e;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .concept-description {
            color: #78350f;
            line-height: 1.6;
        }

        .highlight-box {
            background: linear-gradient(135deg, #ddd6fe, #c4b5fd);
            border: 2px solid #8b5cf6;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            position: relative;
            overflow: hidden;
        }

        .highlight-box::before {
            content: "üí°";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.5em;
        }

        .emoji-list {
            list-style: none;
            padding: 0;
        }

        .emoji-list li {
            padding: 10px 0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .emoji-list .emoji {
            font-size: 1.5em;
            min-width: 30px;
            text-align: center;
        }

        .button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            display: inline-block;
            text-align: center;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .quiz-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            color: #333;
        }

        .question {
            font-size: 1.3em;
            margin-bottom: 25px;
            color: #2d3748;
            font-weight: 500;
        }

        .options {
            display: grid;
            gap: 15px;
        }

        .option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }

        .option:hover {
            background: #edf2f7;
            border-color: #667eea;
            transform: translateX(5px);
        }

        .option.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
        }

        .option.correct {
            background: #48bb78;
            color: white;
            border-color: #48bb78;
            animation: pulse 0.5s ease;
        }

        .option.incorrect {
            background: #f56565;
            color: white;
            border-color: #f56565;
            animation: shake 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 1.1em;
            animation: slideUp 0.3s ease;
        }

        .feedback.correct {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #48bb78;
        }

        .feedback.incorrect {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #f56565;
        }

        @keyframes slideUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .stats {
            display: flex;
            justify-content: space-between;
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        .floating-theory {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .theory-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .theory-modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 700px;
            max-height: 80vh;
            background: white;
            border-radius: 20px;
            padding: 30px;
            overflow-y: auto;
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2em;
            cursor: pointer;
            color: #718096;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #2d3748;
        }

        .final-results {
            background: linear-gradient(135deg, #e0e7ff, #c7d2fe);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            border: 2px solid #6366f1;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .result-label {
            color: #4b5563;
            font-weight: 600;
        }

        .result-value {
            color: #6366f1;
            font-weight: bold;
            font-size: 1.2em;
        }

        .final-message {
            background: linear-gradient(135deg, #fef3c7, #fed7aa);
            border: 2px solid #f59e0b;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }

        .final-message h3 {
            color: #92400e;
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .recommendation {
            background: #fee2e2;
            border: 2px solid #ef4444;
            color: #991b1b;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-weight: 600;
        }

        .progress-bar {
            background: #e2e8f0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            transition: width 0.5s ease;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .container {
                padding: 10px;
            }
            
            .floating-theory {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî¨ BioExplorer üß¨</h1>
            <p>Organizaci√≥n del Cuerpo Humano - 3¬∫ ESO</p>
        </div>

        <!-- Pantalla de Men√∫ -->
        <div id="menuScreen" class="menu-screen">
            <h2 style="color: #667eea; text-align: center; margin-bottom: 20px;">
                Selecciona un Nivel üöÄ
            </h2>
            <div class="level-cards">
                <div class="level-card" onclick="startLevel(1)" id="level1Card">
                    <h3>‚öõÔ∏è Nivel 1: Niveles de Organizaci√≥n</h3>
                    <p>Descubre c√≥mo se organiza la materia desde los √°tomos hasta la biosfera.</p>
                </div>
                <div class="level-card locked" id="level2Card">
                    <h3>üß¨ Nivel 2: Biomol√©culas B√°sicas</h3>
                    <p>Explora los compuestos qu√≠micos esenciales para la vida.</p>
                </div>
                <div class="level-card locked" id="level3Card">
                    <h3>üí™ Nivel 3: Prote√≠nas</h3>
                    <p>Conoce las biomol√©culas m√°s vers√°tiles y sus funciones.</p>
                </div>
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <p style="color: #718096;">Puntuaci√≥n Total: <span id="totalScoreMenu" style="color: #667eea; font-weight: bold;">0</span></p>
            </div>
        </div>

        <!-- Pantalla de Teor√≠a -->
        <div id="theoryScreen" class="theory-screen" style="display: none;">
            <h2 style="color: #667eea; text-align: center; margin-bottom: 20px;">
                üìö Estudia la Teor√≠a
            </h2>
            <div class="theory-content" id="theoryContent"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="button" onclick="startQuiz()">
                    Comenzar Preguntas üéØ
                </button>
            </div>
        </div>

        <!-- Pantalla de Quiz -->
        <div id="quizScreen" class="quiz-screen" style="display: none;">
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="questionNumber">1</div>
                    <div class="stat-label">Pregunta</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="score">0</div>
                    <div class="stat-label">Puntos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">Aciertos</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="incorrectAnswers">0</div>
                    <div class="stat-label">Errores</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="quiz-container">
                <div class="question" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
                <div id="feedbackContainer"></div>
            </div>
        </div>

        <!-- Pantalla Final -->
        <div id="finalScreen" class="final-screen" style="display: none;">
            <div style="text-align: center;">
                <h2 style="color: #667eea; font-size: 2.5em; margin-bottom: 20px;">
                    üéâ ¬°Enhorabuena! üéâ
                </h2>
                <p style="font-size: 1.3em; color: #4a5568; margin-bottom: 30px;">
                    Has completado todos los niveles
                </p>
                
                <div class="final-results">
                    <h3 style="color: #4338ca; margin-bottom: 20px; font-size: 1.5em;">üìä Resultados Finales</h3>
                    <div class="result-row">
                        <span class="result-label">‚úÖ Aciertos Totales:</span>
                        <span class="result-value" id="totalCorrect">0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">‚ùå Errores Totales:</span>
                        <span class="result-value" id="totalIncorrect">0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">üèÜ Puntuaci√≥n Final:</span>
                        <span class="result-value" id="finalScore">0</span>
                    </div>
                </div>

                <div class="final-message">
                    <h3>üìù ENSE√ëA ESTA TAREA AL PROFESOR</h3>
                </div>

                <div id="recommendationBox"></div>

                <button class="button" onclick="resetGame()">
                    Volver a Empezar üîÑ
                </button>
            </div>
        </div>

        <!-- Bot√≥n flotante de teor√≠a -->
        <div class="floating-theory" id="floatingTheory" style="display: none;">
            <button class="button" onclick="showTheoryModal()">
                üìñ Ver Teor√≠a
            </button>
        </div>

        <!-- Modal de teor√≠a -->
        <div id="theoryModal" class="theory-modal">
            <div class="theory-modal-content">
                <span class="close-modal" onclick="closeTheoryModal()">&times;</span>
                <h2 style="color: #667eea; margin-bottom: 20px;">üìö Teor√≠a del Nivel</h2>
                <div id="modalTheoryContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Datos del juego
        const gameData = {
            currentLevel: 0,
            currentQuestion: 0,
            score: 0,
            totalScore: 0,
            correctAnswers: 0,
            incorrectAnswers: 0,
            totalCorrectAnswers: 0,
            totalIncorrectAnswers: 0,
            levelScores: [0, 0, 0],
            completedLevels: [],
            attemptedCurrent: false
        };

        // Teor√≠a de cada nivel con formato mejorado
        const theories = {
            1: `
                <div class="theory-section">
                    <h2 class="theory-title">‚öõÔ∏è Niveles de Organizaci√≥n de la Materia</h2>
                    <p style="color: #475569; margin-bottom: 20px;">La materia viva se organiza en diferentes niveles, desde lo m√°s simple hasta lo m√°s complejo. ¬°Vamos a explorarlos!</p>
                    
                    <div class="highlight-box">
                        <h3 style="color: #5b21b6;">üî¨ Nivel Microsc√≥pico</h3>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">‚öõÔ∏è √Åtomos</div>
                        <div class="concept-description">Part√≠culas fundamentales que forman toda la materia del universo. Son la unidad m√°s peque√±a de un elemento qu√≠mico.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üß™ Mol√©culas</div>
                        <div class="concept-description">Uni√≥n qu√≠mica de dos o m√°s √°tomos que forman compuestos. Por ejemplo, H‚ÇÇO (agua) = 2 √°tomos de hidr√≥geno + 1 de ox√≠geno.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">ü¶† C√©lula</div>
                        <div class="concept-description">¬°La unidad estructural y funcional de la vida! Formada por mol√©culas organizadas. Es el ser vivo m√°s peque√±o que existe.</div>
                    </div>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">ü´Ä Nivel Macrosc√≥pico</h2>
                    
                    <div class="concept-card">
                        <div class="concept-title">üß± Tejidos</div>
                        <div class="concept-description">Agrupaci√≥n de c√©lulas semejantes que realizan una funci√≥n determinada. Ejemplo: tejido muscular, tejido nervioso.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">ü´Å √ìrganos</div>
                        <div class="concept-description">Conjunto de diferentes tejidos que trabajan coordinadamente. Ejemplo: el coraz√≥n tiene tejido muscular, nervioso y conectivo.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üèÉ Sistemas</div>
                        <div class="concept-description">Conjunto de √≥rganos que act√∫an coordinadamente para realizar funciones vitales complejas. Ejemplo: sistema digestivo, circulatorio.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üë§ Organismo</div>
                        <div class="concept-description">Ser vivo individual pluricelular formado por sistemas que funcionan como una unidad. ¬°Como t√∫!</div>
                    </div>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">üåç Nivel Ecol√≥gico</h2>
                    
                    <div class="concept-card">
                        <div class="concept-title">üß¨ Especie</div>
                        <div class="concept-description">Conjunto de organismos con capacidad de reproducirse entre s√≠ y tener descendencia f√©rtil.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üë• Poblaci√≥n</div>
                        <div class="concept-description">Individuos de la misma especie que viven en un mismo lugar y tiempo compartiendo recursos.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üå≥ Comunidad</div>
                        <div class="concept-description">Conjunto de poblaciones de diferentes especies que viven e interact√∫an en un mismo lugar.</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üèûÔ∏è Ecosistema</div>
                        <div class="concept-description">Sistema formado por la comunidad de seres vivos m√°s el medio f√≠sico donde habitan (agua, suelo, clima).</div>
                    </div>
                    
                    <div class="concept-card">
                        <div class="concept-title">üåé Biosfera</div>
                        <div class="concept-description">Conjunto de todos los ecosistemas del planeta Tierra donde existe vida. ¬°Nuestro hogar!</div>
                    </div>
                </div>
            `,
            2: `
                <div class="theory-section">
                    <h2 class="theory-title">üß¨ Bioelementos: Los Ladrillos de la Vida</h2>
                    
                    <div class="highlight-box">
                        <h3 style="color: #5b21b6;">üìä Clasificaci√≥n por Abundancia</h3>
                    </div>
                    
                    <ul class="emoji-list">
                        <li>
                            <span class="emoji">ü•á</span>
                            <div>
                                <div class="concept-title">Macroelementos (96%)</div>
                                <div class="concept-description">C, H, O, N, P, S - Los m√°s abundantes. El carbono es la base de todas las mol√©culas org√°nicas.</div>
                            </div>
                        </li>
                        <li>
                            <span class="emoji">ü•à</span>
                            <div>
                                <div class="concept-title">Microelementos (3%)</div>
                                <div class="concept-description">Na, K, Cl, Mg, Ca, Si - Imprescindibles para la transmisi√≥n nerviosa y contracci√≥n muscular.</div>
                            </div>
                        </li>
                        <li>
                            <span class="emoji">ü•â</span>
                            <div>
                                <div class="concept-title">Oligoelementos (1%)</div>
                                <div class="concept-description">Cr, Co, Fe, Zn - En cantidades m√≠nimas pero esenciales. El hierro forma la hemoglobina.</div>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">üíß Biomol√©culas Inorg√°nicas</h2>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #dbeafe, #bfdbfe);">
                        <div class="concept-title">üíß Agua (H‚ÇÇO)</div>
                        <div class="concept-description">
                            ‚Ä¢ Constituye el 70% de tu cuerpo<br>
                            ‚Ä¢ Disolvente universal<br>
                            ‚Ä¢ Regula la temperatura corporal<br>
                            ‚Ä¢ Transporta nutrientes y desechos
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #e0e7ff, #c7d2fe);">
                        <div class="concept-title">üßÇ Sales Minerales</div>
                        <div class="concept-description">
                            ‚Ä¢ Carbonato c√°lcico ‚Üí Huesos y dientes<br>
                            ‚Ä¢ Cloruro s√≥dico ‚Üí Impulsos nerviosos<br>
                            ‚Ä¢ Fosfato c√°lcico ‚Üí Esqueleto<br>
                            ‚Ä¢ Hierro ‚Üí Transporte de ox√≠geno
                        </div>
                    </div>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">üçØ Gl√∫cidos: La Energ√≠a R√°pida</h2>
                    
                    <div class="highlight-box">
                        <p><strong>Composici√≥n:</strong> Carbono (C) + Hidr√≥geno (H) + Ox√≠geno (O)</p>
                        <p><strong>Funci√≥n principal:</strong> ¬°Energ√≠a inmediata!</p>
                    </div>
                    
                    <ul class="emoji-list">
                        <li>
                            <span class="emoji">üç¨</span>
                            <div>
                                <div class="concept-title">Az√∫cares Simples</div>
                                <div class="concept-description">
                                    <strong>Monosac√°ridos:</strong> Glucosa, fructosa<br>
                                    <strong>Disac√°ridos:</strong> Sacarosa (az√∫car de mesa), lactosa (leche)<br>
                                    ‚úì Sabor dulce ‚úì Solubles en agua ‚úì Energ√≠a r√°pida
                                </div>
                            </div>
                        </li>
                        <li>
                            <span class="emoji">üçû</span>
                            <div>
                                <div class="concept-title">Az√∫cares Complejos (Polisac√°ridos)</div>
                                <div class="concept-description">
                                    <strong>Almid√≥n:</strong> Reserva energ√©tica en plantas<br>
                                    <strong>Gluc√≥geno:</strong> Reserva energ√©tica en animales<br>
                                    <strong>Celulosa:</strong> Estructura en vegetales<br>
                                    ‚úì Sin sabor dulce ‚úì Insolubles en agua
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">ü•ë L√≠pidos: Las Grasas</h2>
                    
                    <div class="highlight-box">
                        <p><strong>Caracter√≠stica clave:</strong> TODOS son insolubles en agua (hidrof√≥bicos)</p>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #fecaca, #fca5a5);">
                        <div class="concept-title">üßà √Åcidos Grasos Saturados</div>
                        <div class="concept-description">
                            ‚Ä¢ Enlaces simples C-C<br>
                            ‚Ä¢ S√≥lidos a temperatura ambiente<br>
                            ‚Ä¢ Ejemplos: mantequilla, sebo<br>
                            ‚Ä¢ ‚ö†Ô∏è M√°s perjudiciales para la salud cardiovascular
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #bbf7d0, #86efac);">
                        <div class="concept-title">ü•ë √Åcidos Grasos Insaturados</div>
                        <div class="concept-description">
                            ‚Ä¢ Dobles enlaces C=C<br>
                            ‚Ä¢ L√≠quidos a temperatura ambiente<br>
                            ‚Ä¢ Ejemplos: aceite de oliva, aguacate<br>
                            ‚Ä¢ ‚úÖ Beneficiosos: reducen colesterol malo (LDL)
                        </div>
                    </div>
                    
                    <div class="highlight-box">
                        <h3 style="color: #5b21b6;">‚ö° Funciones de los L√≠pidos</h3>
                        <p>‚Ä¢ <strong>Energ√©tica:</strong> Proporcionan m√°s energ√≠a que los gl√∫cidos<br>
                        ‚Ä¢ <strong>Estructural:</strong> Forman membranas celulares<br>
                        ‚Ä¢ <strong>Reguladora:</strong> Hormonas esteroideas</p>
                    </div>
                </div>
            `,
            3: `
                <div class="theory-section">
                    <h2 class="theory-title">üí™ Prote√≠nas: Las Mol√©culas Vers√°tiles</h2>
                    
                    <div class="highlight-box">
                        <h3 style="color: #5b21b6;">üß¨ Estructura B√°sica</h3>
                        <p><strong>Composici√≥n:</strong> C, H, O, N (y a veces P, S)<br>
                        <strong>Unidad b√°sica:</strong> 20 amino√°cidos diferentes<br>
                        <strong>Importancia:</strong> ¬°Las biomol√©culas m√°s vers√°tiles!</p>
                    </div>
                </div>

                <div class="theory-section">
                    <h2 class="theory-title">üé≠ Las 6 Funciones Principales</h2>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #fef3c7, #fde68a);">
                        <div class="concept-title">üõ°Ô∏è 1. Funci√≥n de DEFENSA</div>
                        <div class="concept-description">
                            <strong>Anticuerpos (Inmunoglobulinas):</strong><br>
                            ‚Ä¢ Identifican y neutralizan virus, bacterias y hongos<br>
                            ‚Ä¢ Se adhieren al pat√≥geno y alertan al sistema inmune<br>
                            ‚Ä¢ ¬°Son como los soldados de tu cuerpo!
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #fecaca, #fca5a5);">
                        <div class="concept-title">üí™ 2. Funci√≥n CONTR√ÅCTIL</div>
                        <div class="concept-description">
                            <strong>Actina y Miosina:</strong><br>
                            ‚Ä¢ Permiten la contracci√≥n muscular<br>
                            ‚Ä¢ Hacen posible el movimiento<br>
                            ‚Ä¢ ¬°Gracias a ellas puedes correr, saltar y bailar!
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #ddd6fe, #c4b5fd);">
                        <div class="concept-title">üèóÔ∏è 3. Funci√≥n ESTRUCTURAL</div>
                        <div class="concept-description">
                            <strong>Tres tipos importantes:</strong><br>
                            ‚Ä¢ <strong>Glucoprote√≠nas:</strong> Forman membranas celulares<br>
                            ‚Ä¢ <strong>Col√°geno:</strong> Da flexibilidad a tendones y piel<br>
                            ‚Ä¢ <strong>Queratina:</strong> Forma pelo, u√±as y epidermis
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #dbeafe, #bfdbfe);">
                        <div class="concept-title">üöö 4. Funci√≥n de TRANSPORTE</div>
                        <div class="concept-description">
                            <strong>Transportadores esenciales:</strong><br>
                            ‚Ä¢ <strong>Hemoglobina:</strong> Transporta O‚ÇÇ en gl√≥bulos rojos<br>
                            ‚Ä¢ <strong>Lipoprote√≠nas:</strong> Transportan grasas en la sangre<br>
                            ‚Ä¢ ¬°Como camiones de reparto en tu cuerpo!
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #bbf7d0, #86efac);">
                        <div class="concept-title">‚ö° 5. Funci√≥n ENZIM√ÅTICA</div>
                        <div class="concept-description">
                            <strong>Enzimas = Catalizadores biol√≥gicos:</strong><br>
                            ‚Ä¢ Aceleran reacciones qu√≠micas sin consumirse<br>
                            ‚Ä¢ <strong>Amilasa:</strong> Digiere almid√≥n<br>
                            ‚Ä¢ <strong>Pepsina:</strong> Digiere prote√≠nas<br>
                            ‚Ä¢ <strong>Lipasa:</strong> Digiere grasas
                        </div>
                    </div>
                    
                    <div class="concept-card" style="background: linear-gradient(135deg, #fed7e7, #fbb6ce);">
                        <div class="concept-title">üì° 6. Funci√≥n HORMONAL</div>
                        <div class="concept-description">
                            <strong>Hormonas proteicas = Mensajeros qu√≠micos:</strong><br>
                            ‚Ä¢ <strong>Insulina:</strong> Regula el az√∫car en sangre<br>
                            ‚Ä¢ <strong>Hormona del crecimiento:</strong> Controla el desarrollo<br>
                            ‚Ä¢ ¬°Como WhatsApp pero en tu cuerpo!
                        </div>
                    </div>
                </div>

                <div class="highlight-box">
                    <h3 style="color: #5b21b6;">üí° Dato Curioso</h3>
                    <p>¬°Tu cuerpo tiene m√°s de 100.000 prote√≠nas diferentes, cada una con una funci√≥n espec√≠fica!</p>
                </div>
            `
        };

        // Preguntas de cada nivel
        const questions = {
            1: [
                {
                    question: "¬øCu√°l es la unidad estructural y funcional de vida?",
                    options: ["√Åtomo", "C√©lula", "Tejido", "Mol√©cula"],
                    correct: 1,
                    explanation: "La c√©lula es la unidad estructural y funcional de vida, formada por mol√©culas organizadas."
                },
                {
                    question: "¬øQu√© nivel viene despu√©s de los tejidos?",
                    options: ["Sistema", "√ìrganos", "Poblaci√≥n", "C√©lula"],
                    correct: 1,
                    explanation: "Los √≥rganos son el conjunto de diferentes tejidos que trabajan coordinadamente."
                },
                {
                    question: "¬øQu√© es una poblaci√≥n?",
                    options: ["Individuos de especies diferentes", "Individuos de la misma especie en un lugar", "Conjunto de tejidos", "Un ecosistema"],
                    correct: 1,
                    explanation: "Poblaci√≥n: individuos de la misma especie que viven en un mismo lugar y tiempo."
                },
                {
                    question: "¬øQu√© es un ecosistema?",
                    options: ["Solo organismos", "Comunidad + medio f√≠sico", "Grupo de c√©lulas", "Solo el ambiente"],
                    correct: 1,
                    explanation: "Ecosistema = comunidad de seres vivos + medio f√≠sico donde habitan."
                }
            ],
            2: [
                {
                    question: "¬øCu√°les son los macroelementos principales?",
                    options: ["Na, K, Cl", "C, H, O, N, P, S", "Cr, Co", "Fe, Zn"],
                    correct: 1,
                    explanation: "Macroelementos: C, H, O, N, P, S son los m√°s abundantes en los seres vivos."
                },
                {
                    question: "¬øQu√© porcentaje del organismo es agua?",
                    options: ["50%", "60%", "70%", "80%"],
                    correct: 2,
                    explanation: "El agua constituye el 70% del organismo, siendo el disolvente universal."
                },
                {
                    question: "¬øQu√© sales forman parte de los huesos?",
                    options: ["Cloruro s√≥dico", "Carbonato c√°lcico", "Sulfato de magnesio", "Fosfato de potasio"],
                    correct: 1,
                    explanation: "El carbonato c√°lcico forma parte de huesos, conchas y caparazones."
                },
                {
                    question: "Funci√≥n de monosac√°ridos y disac√°ridos:",
                    options: ["Estructural", "Energ√©tica", "Transporte", "Defensa"],
                    correct: 1,
                    explanation: "Monosac√°ridos y disac√°ridos tienen funci√≥n energ√©tica, son dulces y solubles."
                },
                {
                    question: "Caracter√≠stica de todos los l√≠pidos:",
                    options: ["Son dulces", "Insolubles en agua", "Tienen nitr√≥geno", "Son prote√≠nas"],
                    correct: 1,
                    explanation: "Todos los l√≠pidos son insolubles en agua (hidrof√≥bicos)."
                },
                {
                    question: "¬øQu√© √°cidos grasos son m√°s saludables?",
                    options: ["Saturados", "Insaturados", "Ambos igual", "Ninguno"],
                    correct: 1,
                    explanation: "Insaturados: reducen colesterol malo LDL y aumentan el bueno HDL."
                }
            ],
            3: [
                {
                    question: "¬øCu√°ntos amino√°cidos forman las prote√≠nas?",
                    options: ["10", "15", "20", "25"],
                    correct: 2,
                    explanation: "Las prote√≠nas est√°n formadas por 20 amino√°cidos diferentes."
                },
                {
                    question: "¬øQu√© prote√≠nas defienden de pat√≥genos?",
                    options: ["Actina", "Anticuerpos", "Col√°geno", "Hemoglobina"],
                    correct: 1,
                    explanation: "Anticuerpos o inmunoglobulinas defienden contra virus, bacterias y hongos."
                },
                {
                    question: "Prote√≠nas de la contracci√≥n muscular:",
                    options: ["Insulina y glucag√≥n", "Actina y miosina", "Col√°geno y queratina", "Hemoglobina"],
                    correct: 1,
                    explanation: "Actina y miosina permiten la contracci√≥n muscular y el movimiento."
                },
                {
                    question: "Prote√≠na que da flexibilidad a tendones:",
                    options: ["Queratina", "Col√°geno", "Insulina", "Hemoglobina"],
                    correct: 1,
                    explanation: "Col√°geno: proporciona flexibilidad y resistencia a tendones y piel."
                },
                {
                    question: "¬øQu√© transporta la hemoglobina?",
                    options: ["Glucosa", "Ox√≠geno", "L√≠pidos", "Prote√≠nas"],
                    correct: 1,
                    explanation: "Hemoglobina transporta ox√≠geno desde los pulmones a las c√©lulas."
                },
                {
                    question: "Funci√≥n de las enzimas:",
                    options: ["Defender", "Acelerar reacciones", "Transportar", "Formar estructuras"],
                    correct: 1,
                    explanation: "Enzimas aceleran (catalizan) las reacciones qu√≠micas del metabolismo."
                }
            ]
        };

        // Funciones del juego
        function startLevel(level) {
            if (level === 1 || gameData.completedLevels.includes(level - 1)) {
                gameData.currentLevel = level;
                gameData.currentQuestion = 0;
                gameData.score = 0;
                gameData.correctAnswers = 0;
                gameData.incorrectAnswers = 0;
                showTheory();
            }
        }

        function showTheory() {
            document.getElementById('menuScreen').style.display = 'none';
            document.getElementById('theoryScreen').style.display = 'block';
            document.getElementById('theoryContent').innerHTML = theories[gameData.currentLevel];
            document.getElementById('modalTheoryContent').innerHTML = theories[gameData.currentLevel];
        }

        function startQuiz() {
            document.getElementById('theoryScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            document.getElementById('floatingTheory').style.display = 'block';
            gameData.attemptedCurrent = false;
            showQuestion();
        }

        function showQuestion() {
            const levelQuestions = questions[gameData.currentLevel];
            const currentQ = levelQuestions[gameData.currentQuestion];
            
            document.getElementById('questionNumber').textContent = gameData.currentQuestion + 1;
            document.getElementById('score').textContent = gameData.score;
            document.getElementById('correctAnswers').textContent = gameData.correctAnswers;
            document.getElementById('incorrectAnswers').textContent = gameData.incorrectAnswers;
            
            // Actualizar barra de progreso
            const progress = ((gameData.currentQuestion) / levelQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('questionText').textContent = currentQ.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            currentQ.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('feedbackContainer').innerHTML = '';
            gameData.attemptedCurrent = false;
        }

        function selectOption(index) {
            if (gameData.attemptedCurrent && questions[gameData.currentLevel][gameData.currentQuestion].correct === index) {
                return;
            }
            
            const options = document.querySelectorAll('.option');
            const currentQ = questions[gameData.currentLevel][gameData.currentQuestion];
            const feedbackContainer = document.getElementById('feedbackContainer');
            
            options.forEach((opt, i) => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.onclick = null;
            });
            
            if (index === currentQ.correct) {
                // Respuesta correcta
                options[index].classList.add('correct');
                
                if (!gameData.attemptedCurrent) {
                    gameData.score += 10;
                    gameData.correctAnswers++;
                    gameData.totalCorrectAnswers++;
                } else {
                    gameData.score += 5;
                }
                
                feedbackContainer.innerHTML = `
                    <div class="feedback correct">
                        ‚úÖ ¬°Correcto! ${currentQ.explanation}
                    </div>
                `;
                
                document.getElementById('score').textContent = gameData.score;
                document.getElementById('correctAnswers').textContent = gameData.correctAnswers;
                
                setTimeout(() => {
                    nextQuestion();
                }, 2000);
            } else {
                // Respuesta incorrecta
                options[index].classList.add('incorrect');
                
                if (!gameData.attemptedCurrent) {
                    gameData.incorrectAnswers++;
                    gameData.totalIncorrectAnswers++;
                    gameData.attemptedCurrent = true;
                }
                
                feedbackContainer.innerHTML = `
                    <div class="feedback incorrect">
                        ‚ùå Incorrecto. ${currentQ.explanation}
                        <button class="button" style="margin-top: 10px;" onclick="retryQuestion()">
                            Intentar de nuevo (-5 puntos)
                        </button>
                    </div>
                `;
                
                document.getElementById('incorrectAnswers').textContent = gameData.incorrectAnswers;
            }
        }

        function retryQuestion() {
            showQuestion();
        }

        function nextQuestion() {
            gameData.currentQuestion++;
            const levelQuestions = questions[gameData.currentLevel];
            
            if (gameData.currentQuestion < levelQuestions.length) {
                showQuestion();
            } else {
                completeLevel();
            }
        }

        function completeLevel() {
            // Guardar puntuaci√≥n del nivel
            gameData.levelScores[gameData.currentLevel - 1] = gameData.score;
            gameData.totalScore += gameData.score;
            
            // Marcar nivel como completado
            if (!gameData.completedLevels.includes(gameData.currentLevel)) {
                gameData.completedLevels.push(gameData.currentLevel);
            }
            
            // Mostrar mensaje de nivel completado
            alert(`¬°Nivel ${gameData.currentLevel} completado!\n\nPuntos del nivel: ${gameData.score}\nPuntos totales: ${gameData.totalScore}`);
            
            document.getElementById('floatingTheory').style.display = 'none';
            
            if (gameData.completedLevels.length === 3) {
                showFinalScreen();
            } else {
                returnToMenu();
            }
        }

        function returnToMenu() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'block';
            document.getElementById('totalScoreMenu').textContent = gameData.totalScore;
            
            // Actualizar estado de las tarjetas
            gameData.completedLevels.forEach(level => {
                document.getElementById(`level${level}Card`).classList.add('completed');
            });
            
            // Desbloquear siguiente nivel
            if (gameData.completedLevels.includes(1)) {
                document.getElementById('level2Card').classList.remove('locked');
                document.getElementById('level2Card').onclick = () => startLevel(2);
            }
            if (gameData.completedLevels.includes(2)) {
                document.getElementById('level3Card').classList.remove('locked');
                document.getElementById('level3Card').onclick = () => startLevel(3);
            }
        }

        function showFinalScreen() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('finalScreen').style.display = 'block';
            
            // Mostrar estad√≠sticas finales
            document.getElementById('totalCorrect').textContent = gameData.totalCorrectAnswers;
            document.getElementById('totalIncorrect').textContent = gameData.totalIncorrectAnswers;
            document.getElementById('finalScore').textContent = gameData.totalScore;
            
            // Mostrar recomendaci√≥n si hay m√°s de 3 errores
            const recommendationBox = document.getElementById('recommendationBox');
            if (gameData.totalIncorrectAnswers > 3) {
                recommendationBox.innerHTML = `
                    <div class="recommendation">
                        ‚ö†Ô∏è Has tenido ${gameData.totalIncorrectAnswers} errores.<br>
                        Te recomendamos volver a hacer la actividad para mejorar tu aprendizaje.
                    </div>
                `;
            } else {
                recommendationBox.innerHTML = `
                    <div style="background: #d1fae5; border: 2px solid #10b981; color: #065f46; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: center; font-weight: 600;">
                        üåü ¬°Excelente trabajo! Has demostrado un gran dominio del tema.
                    </div>
                `;
            }
        }

        function resetGame() {
            // Reiniciar todos los datos del juego
            gameData.currentLevel = 0;
            gameData.currentQuestion = 0;
            gameData.score = 0;
            gameData.totalScore = 0;
            gameData.correctAnswers = 0;
            gameData.incorrectAnswers = 0;
            gameData.totalCorrectAnswers = 0;
            gameData.totalIncorrectAnswers = 0;
            gameData.levelScores = [0, 0, 0];
            gameData.completedLevels = [];
            gameData.attemptedCurrent = false;
            
            // Reiniciar interfaz
            document.getElementById('finalScreen').style.display = 'none';
            document.getElementById('menuScreen').style.display = 'block';
            document.getElementById('totalScoreMenu').textContent = '0';
            
            // Resetear tarjetas de nivel
            document.getElementById('level1Card').classList.remove('completed');
            document.getElementById('level2Card').classList.remove('completed');
            document.getElementById('level2Card').classList.add('locked');
            document.getElementById('level2Card').onclick = null;
            document.getElementById('level3Card').classList.remove('completed');
            document.getElementById('level3Card').classList.add('locked');
            document.getElementById('level3Card').onclick = null;
        }

        function showTheoryModal() {
            document.getElementById('theoryModal').style.display = 'block';
        }

        function closeTheoryModal() {
            document.getElementById('theoryModal').style.display = 'none';
        }

        // Cerrar modal al hacer clic fuera
        window.onclick = function(event) {
            const modal = document.getElementById('theoryModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }
    </script>
</body>
</html>